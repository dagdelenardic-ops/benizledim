# Kimi K2.5 - Görev Talimatları

## Sen Kimsin
Sen "Ben İzledim" projesinin **uygulayıcı geliştiricisi**sin. Baş mimar (Claude) tarafından belirlenen mimari kararlara ve CLAUDE.md dosyasındaki kurallara MUTLAKA uymalısın.

## Temel Kurallar

1. **CLAUDE.md dosyasını her zaman oku** - Her göreve başlamadan önce CLAUDE.md'yi oku ve oradaki yapıya uy.
2. **Dosya yapısını değiştirme** - CLAUDE.md'de tanımlanan klasör yapısına uy.
3. **Küçük commit'ler at** - "feat:", "fix:", "chore:" prefix'leri kullan.
4. **Sormaktan çekinme** - Emin olmadığın bir şey varsa dur ve sor.

## Durum: Faz 1 TAMAMLANDI ✅

Faz 1 (Proje Kurulumu) baş mimar tarafından tamamlandı:
- Laravel 12 + Vue 3 + Inertia.js v2 + Tailwind CSS 4 kurulu
- Tüm migration'lar yazıldı ve çalıştırıldı (SQLite)
- Tüm Eloquent modeller ve ilişkileri tanımlı
- Seeder'lar yazıldı (7 kullanıcı, 8 kategori, 8 tag, 8 yazı)
- Temel Home.vue ve AppLayout.vue oluşturuldu
- Inertia middleware aktif

## ŞİMDİKİ GÖREVİN: Faz 2 - Auth Sistemi

### Adım 1: Google OAuth Ayarla
- `config/services.php` dosyasına Google ve Facebook provider ekle
- `.env.example`'a gerekli key'leri ekle:
  ```
  GOOGLE_CLIENT_ID=
  GOOGLE_CLIENT_SECRET=
  GOOGLE_REDIRECT_URI=${APP_URL}/auth/google/callback
  FACEBOOK_CLIENT_ID=
  FACEBOOK_CLIENT_SECRET=
  FACEBOOK_REDIRECT_URI=${APP_URL}/auth/facebook/callback
  ```

### Adım 2: Auth Controller Oluştur
`app/Http/Controllers/Auth/SocialAuthController.php`:
- `redirectToGoogle()` - Google'a yönlendir
- `handleGoogleCallback()` - Google'dan dönen kullanıcıyı işle
- `redirectToFacebook()` - Facebook'a yönlendir
- `handleFacebookCallback()` - Facebook'dan dönen kullanıcıyı işle

Callback mantığı:
```php
// Provider'dan kullanıcı bilgisi al
$socialUser = Socialite::driver('google')->user();

// DB'de var mı kontrol et (provider_id ile)
$user = User::where('provider', 'google')
    ->where('provider_id', $socialUser->id)
    ->first();

// Yoksa oluştur
if (!$user) {
    $user = User::create([
        'name' => $socialUser->name,
        'email' => $socialUser->email,
        'avatar' => $socialUser->avatar,
        'provider' => 'google',
        'provider_id' => $socialUser->id,
        'role' => 'reader',
    ]);
}

// Giriş yap ve ana sayfaya yönlendir
Auth::login($user);
return redirect('/');
```

### Adım 3: Auth Route'ları
`routes/auth.php` oluştur ve `bootstrap/app.php`'de yükle:
```php
// Social Auth
Route::get('/auth/google', [SocialAuthController::class, 'redirectToGoogle']);
Route::get('/auth/google/callback', [SocialAuthController::class, 'handleGoogleCallback']);
Route::get('/auth/facebook', [SocialAuthController::class, 'redirectToFacebook']);
Route::get('/auth/facebook/callback', [SocialAuthController::class, 'handleFacebookCallback']);

// Logout
Route::post('/logout', [SocialAuthController::class, 'logout'])->middleware('auth');
```

### Adım 4: LoginModal Vue Component
`resources/js/Components/Auth/LoginModal.vue`:
- Modal overlay (arka plan karartılmış)
- "Giriş Yapın" başlığı
- "Bu siteye yeni misiniz? Kaydolun" linki
- Google ile giriş butonu (beyaz, Google logosu ile)
- Facebook ile giriş butonu (mavi, Facebook logosu ile)
- "veya" ayırıcı
- "E-Postanızla giriş yapın" butonu
- Kapatma (X) butonu sağ üstte

### Adım 5: Navbar'a Auth Entegrasyonu
`AppLayout.vue` güncelle:
- Giriş yapmamışsa: "Giriş" butonu göster -> tıklayınca LoginModal aç
- Giriş yapmışsa: Kullanıcı avatarı + adı göster, dropdown menüde "Çıkış Yap"
- Inertia'nın `usePage()` ile `auth.user` bilgisini al

### Adım 6: HandleInertiaRequests Middleware Güncelle
`share()` metodunda auth bilgisini paylaş:
```php
public function share(Request $request): array
{
    return [
        ...parent::share($request),
        'auth' => [
            'user' => $request->user() ? [
                'id' => $request->user()->id,
                'name' => $request->user()->name,
                'email' => $request->user()->email,
                'avatar' => $request->user()->avatar,
                'role' => $request->user()->role,
            ] : null,
        ],
    ];
}
```

### Test Kontrol Listesi
- [ ] Google butonu tıklayınca Google OAuth sayfasına yönlendiriyor
- [ ] Başarılı girişten sonra ana sayfaya dönüyor
- [ ] Navbar'da kullanıcı bilgisi görünüyor
- [ ] Çıkış Yap çalışıyor
- [ ] LoginModal düzgün açılıp kapanıyor
- [ ] Giriş yapmadan yazı yazma/yorum yapma engellenmiş

## ÖNEMLİ: Yapma Listesi
- ❌ WordPress veya başka CMS entegre etme
- ❌ React kullanma (Vue.js kullanıyoruz)
- ❌ API-only backend yapma (Inertia.js kullanıyoruz)
- ❌ Tailwind dışında CSS framework kullanma
- ❌ TypeScript kullanma (JavaScript yeterli)
- ❌ Docker/container setup yapma (shared hosting'e deploy edeceğiz)
- ❌ Gereksiz paket ekleme
- ❌ Dark mode ekleme (şimdilik yok)
- ❌ i18n/çoklu dil ekleme (şimdilik sadece Türkçe)
- ❌ E-posta ile kayıt/giriş (şimdilik sadece Google + Facebook)
- ❌ Mevcut migration veya model dosyalarını SİLME veya BAŞTAN YAZMA

## Renk Paleti
- Primary: #DC2626 (kırmızı)
- Background: #FFFFFF (beyaz)
- Text: #111827 (koyu siyah)
- Secondary text: #6B7280 (gri)
- Border: #E5E7EB (açık gri)
- Navbar bg: #DC2626 (kırmızı)
- Navbar text: #FFFFFF (beyaz)
- Footer bg: #111827 (siyah)
- Footer text: #FFFFFF (beyaz)
